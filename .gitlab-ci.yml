stages:
    - build
    - test
    - deploy
    
build_job:
    stage: build
    image: python:3.8-slim
    needs: 
    script:
        - sudo docker build -t playground -f dockerfile ./taski/backend 
        - sudo docker run -p 8080:80 playground
    artifacts: 
        paths:
            - "./backend/build_release/"
    rules:
    - when: on_success
            
test_job:
    stage: test
    image: python:3.8-slim
    needs:
        - build_job
    script:
        - cd ./taski/backend
        - python manage.py
    artifacts:
        paths:
    rules:
    - when: on_success

deploy_job:
    stage: deploy
    script:
        - cd ./taski/backend
        - python manage.py
    only: 
        - backend_production

